<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crypto Market Analyzer</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;500&display=swap">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/moment@2.29.4/moment.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-moment@1.0.1/dist/chartjs-adapter-moment.min.js"></script>
</head>
<body>
    <div class="container-fluid">
        <div class="row">
            <!-- Sidebar -->
            <div class="col-md-3 sidebar">
                <div class="sidebar-content">
                    <h2 class="text-center mb-4">Market Analysis</h2>
                    
                    <!-- Product Selection -->
                    <div class="mb-3">
                        <label for="product" class="form-label">Select Product:</label>
                        <select id="product" class="form-select">
                            {% for product in products %}
                            <option value="{{ product }}" {% if product == config.product %}selected{% endif %}>{{ product }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    
                    <!-- Price Display -->
                    <div class="price-display mb-3">
                        <h5>Current Price:</h5>
                        <div id="current-price" class="price">-.--</div>
                        <div id="price-time" class="price-time">Last update: Never</div>
                    </div>
                    
                    <!-- Model Selection -->
                    <div class="mb-3">
                        <label for="model" class="form-label">Select Model:</label>
                        <select id="model" class="form-select">
                            {% for key, value in models.items() %}
                            <option value="{{ key }}" {% if key == config.model %}selected{% endif %}>{{ value }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    
                    <!-- Granularity Selection -->
                    <div class="mb-3">
                        <label for="granularity" class="form-label">Time Frame:</label>
                        <select id="granularity" class="form-select">
                            {% for granularity in granularities %}
                            <option value="{{ granularity }}" {% if granularity == config.granularity %}selected{% endif %}>{{ granularity.replace('_', ' ').title() }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    
                    <!-- Trading Options -->
                    <div class="mb-3">
                        <div class="card trading-options-card">
                            <div class="card-header">
                                <div class="form-check form-switch">
                                    <input class="form-check-input" type="checkbox" id="trading-options-toggle">
                                    <label class="form-check-label" for="trading-options-toggle">Trading Options</label>
                                </div>
                            </div>
                            <div class="card-body trading-options" style="display: none;">
                                <!-- Margin Type -->
                                <div class="mb-2">
                                    <label for="margin" class="form-label">Margin Type:</label>
                                    <select id="margin" class="form-select">
                                        <option value="CROSS" {% if config.margin == "CROSS" %}selected{% endif %}>Cross</option>
                                        <option value="ISOLATED" {% if config.margin == "ISOLATED" %}selected{% endif %}>Isolated</option>
                                    </select>
                                </div>
                                
                                <!-- Margin Amount -->
                                <div class="mb-2">
                                    <label for="margin-amount" class="form-label">Margin Amount ($):</label>
                                    <input type="number" class="form-control" id="margin-amount" value="{{ config.margin_amount }}" min="1" step="1">
                                </div>
                                
                                <!-- Leverage -->
                                <div class="mb-2">
                                    <label for="leverage" class="form-label">Leverage: <span id="leverage-value">{{ config.leverage }}</span>x</label>
                                    <input type="range" class="form-range" id="leverage" min="1" max="20" value="{{ config.leverage }}">
                                </div>
                                
                                <!-- Take Profit / Stop Loss -->
                                <div class="mb-2">
                                    <label for="tp-sl" class="form-label">TP/SL: <span id="tp-sl-value">{{ config.take_profit }}</span>%</label>
                                    <input type="range" class="form-range" id="tp-sl" min="0.5" max="5" step="0.1" value="{{ config.take_profit }}">
                                </div>
                                
                                <!-- Limit Order -->
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="limit-order" {% if config.limit_order %}checked{% endif %}>
                                    <label class="form-check-label" for="limit-order">Use Limit Orders</label>
                                </div>
                                
                                <!-- Risk Level -->
                                <div class="mt-2">
                                    <label for="risk-level" class="form-label">Risk Level:</label>
                                    <select id="risk-level" class="form-select">
                                        <option value="low" {% if config.risk_level == "low" %}selected{% endif %}>Low</option>
                                        <option value="medium" {% if config.risk_level == "medium" %}selected{% endif %}>Medium</option>
                                        <option value="high" {% if config.risk_level == "high" %}selected{% endif %}>High</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Action Buttons -->
                    <div class="mb-3">
                        <button id="analyze-btn" class="btn btn-primary w-100 mb-2">Run Analysis</button>
                        <div class="row mb-2">
                            <div class="col-6">
                                <button id="long-btn" class="btn btn-success w-100">LONG</button>
                            </div>
                            <div class="col-6">
                                <button id="short-btn" class="btn btn-danger w-100">SHORT</button>
                            </div>
                        </div>
                        <button id="close-positions-btn" class="btn btn-warning w-100 mb-2">Close All Positions</button>
                        <button id="check-orders-btn" class="btn btn-info w-100 mb-2">Check Open Orders</button>
                        <button id="auto-trade-btn" class="btn btn-indigo w-100">Start Auto-Trading</button>
                    </div>
                    
                    <!-- Control Buttons -->
                    <div class="mb-3">
                        <div class="row">
                            <div class="col-6">
                                <button id="clear-btn" class="btn btn-outline-secondary w-100">Clear</button>
                            </div>
                            <div class="col-6">
                                <button id="cancel-btn" class="btn btn-outline-danger w-100">Cancel</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Main Content -->
            <div class="col-md-9 main-content">
                <div class="hero-section card mb-4 overflow-hidden position-relative">
                    <div class="row g-0 align-items-center position-relative z-1">
                        <div class="col-lg-7 p-4 p-lg-5">
                            <div class="hero-eyebrow mb-2"><i class="fas fa-satellite-dish me-2"></i>Live AI Market Intelligence</div>
                            <h1 class="hero-title mb-3">Stay Ahead Of Every Move</h1>
                            <p class="hero-subtitle mb-4">Visualize momentum, liquidity, and risk in one unified view for <span class="hero-highlight">{{ config.product }}</span> pairs powered by <span class="hero-highlight">{{ models[config.model] }}</span>.</p>
                            <div class="hero-pills d-flex flex-wrap gap-2">
                                <span class="hero-pill"><i class="fas fa-wave-square me-2"></i>Order Flow Tracking</span>
                                <span class="hero-pill"><i class="fas fa-brain me-2"></i>AI Signal Overlay</span>
                                <span class="hero-pill"><i class="fas fa-stopwatch me-2"></i>{{ config.granularity.replace('_', ' ').title() }} Refresh</span>
                            </div>
                        </div>
                        <div class="col-lg-5 p-4">
                            <div class="hero-visual-frame mx-auto">
                                <img src="{{ url_for('static', filename='images/hero-orbit.svg') }}" class="hero-visual img-fluid" alt="Abstract orbital market visualization">
                            </div>
                        </div>
                    </div>
                    <div class="hero-glow hero-glow-1"></div>
                    <div class="hero-glow hero-glow-2"></div>
                </div>

                <div class="row g-3 mb-4 visual-highlights">
                    <div class="col-lg-4 col-md-6">
                        <div class="visual-card">
                            <div class="visual-card-header">
                                <div class="visual-icon bg-gradient-blue"><i class="fas fa-circle-notch"></i></div>
                                <div>
                                    <h6 class="mb-1">Momentum Snapshot</h6>
                                    <small class="text-muted">Intraday trend strength</small>
                                </div>
                            </div>
                            <div class="visual-spark">
                                <svg class="sparkline" viewBox="0 0 120 48" role="img" aria-label="Momentum sparkline" preserveAspectRatio="none">
                                    <defs>
                                        <linearGradient id="spark-gradient-momentum" x1="0%" y1="0%" x2="100%" y2="0%">
                                            <stop offset="0%" stop-color="#53f3ff" />
                                            <stop offset="100%" stop-color="#4b7bff" />
                                        </linearGradient>
                                    </defs>
                                    <path d="M0 32 C 15 34 18 14 32 18 C 46 22 54 6 68 12 C 82 18 90 8 104 14 C 114 18 118 10 120 8 L120 48 L0 48 Z" fill="url(#spark-gradient-momentum)" opacity="0.18"></path>
                                    <path d="M0 32 C 15 34 18 14 32 18 C 46 22 54 6 68 12 C 82 18 90 8 104 14 C 114 18 118 10 120 8" fill="none" stroke="url(#spark-gradient-momentum)" stroke-width="3" stroke-linecap="round"></path>
                                </svg>
                            </div>
                            <p class="visual-description mb-0">Track how quickly price accelerates against the 24h baseline to refine breakout timing.</p>
                        </div>
                    </div>
                    <div class="col-lg-4 col-md-6">
                        <div class="visual-card">
                            <div class="visual-card-header">
                                <div class="visual-icon bg-gradient-purple"><i class="fas fa-water"></i></div>
                                <div>
                                    <h6 class="mb-1">Liquidity Rivers</h6>
                                    <small class="text-muted">Order book depth map</small>
                                </div>
                            </div>
                            <div class="visual-spark">
                                <svg class="sparkline" viewBox="0 0 120 48" role="img" aria-label="Liquidity sparkline" preserveAspectRatio="none">
                                    <defs>
                                        <linearGradient id="spark-gradient-liquidity" x1="0%" y1="0%" x2="100%" y2="100%">
                                            <stop offset="0%" stop-color="#c084fc" />
                                            <stop offset="100%" stop-color="#7b2ff7" />
                                        </linearGradient>
                                    </defs>
                                    <path d="M0 40 C 10 36 20 34 30 28 C 40 22 48 30 58 24 C 68 18 82 20 92 14 C 102 8 112 10 120 6 L120 48 L0 48 Z" fill="url(#spark-gradient-liquidity)" opacity="0.2"></path>
                                    <path d="M0 40 C 10 36 20 34 30 28 C 40 22 48 30 58 24 C 68 18 82 20 92 14 C 102 8 112 10 120 6" fill="none" stroke="url(#spark-gradient-liquidity)" stroke-width="3" stroke-linecap="round"></path>
                                </svg>
                            </div>
                            <p class="visual-description mb-0">Spot liquidity pools before they move by visualizing stacked bid and ask pressure in real time.</p>
                        </div>
                    </div>
                    <div class="col-lg-4 col-md-6">
                        <div class="visual-card">
                            <div class="visual-card-header">
                                <div class="visual-icon bg-gradient-amber"><i class="fas fa-sun"></i></div>
                                <div>
                                    <h6 class="mb-1">Sentiment Pulse</h6>
                                    <small class="text-muted">News & social drift</small>
                                </div>
                            </div>
                            <div class="visual-spark">
                                <svg class="sparkline" viewBox="0 0 120 48" role="img" aria-label="Sentiment sparkline" preserveAspectRatio="none">
                                    <defs>
                                        <linearGradient id="spark-gradient-sentiment" x1="0%" y1="0%" x2="100%" y2="0%">
                                            <stop offset="0%" stop-color="#ffb347" />
                                            <stop offset="100%" stop-color="#ff6b6b" />
                                        </linearGradient>
                                    </defs>
                                    <path d="M0 36 C 12 30 20 28 32 22 C 46 14 54 26 68 20 C 82 14 92 26 104 18 C 112 12 118 22 120 24 L120 48 L0 48 Z" fill="url(#spark-gradient-sentiment)" opacity="0.18"></path>
                                    <path d="M0 36 C 12 30 20 28 32 22 C 46 14 54 26 68 20 C 82 14 92 26 104 18 C 112 12 118 22 120 24" fill="none" stroke="url(#spark-gradient-sentiment)" stroke-width="3" stroke-linecap="round"></path>
                                </svg>
                            </div>
                            <p class="visual-description mb-0">Blend news tone and community chatter to gauge when momentum aligns with narrative shifts.</p>
                        </div>
                    </div>
                </div>

                <!-- Dashboard Summary Stats -->
                <div class="row mb-4 mt-3">
                    <div class="col-md-3">
                        <div class="dashboard-stat stat-blue">
                            <i class="fas fa-chart-line fa-2x"></i>
                            <div class="dashboard-stat-value" id="current-btc-price">Loading...</div>
                            <div class="dashboard-stat-label">BTC Price</div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="dashboard-stat stat-green">
                            <i class="fas fa-trophy fa-2x"></i>
                            <div class="dashboard-stat-value" id="dashboard-win-rate">0%</div>
                            <div class="dashboard-stat-label">Win Rate</div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="dashboard-stat stat-orange">
                            <i class="fas fa-exchange-alt fa-2x"></i>
                            <div class="dashboard-stat-value" id="dashboard-trades">0</div>
                            <div class="dashboard-stat-label">Total Trades</div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="dashboard-stat stat-red">
                            <i class="fas fa-bolt fa-2x"></i>
                            <div class="dashboard-stat-value" id="dashboard-status">Idle</div>
                            <div class="dashboard-stat-label">System Status</div>
                        </div>
                    </div>
                </div>
                
                <!-- Price Chart -->
                <div class="row mb-4">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <h5 class="mb-0"><i class="fas fa-chart-area me-2"></i>Price History</h5>
                                <div class="btn-group">
                                    <button type="button" class="btn btn-sm btn-outline-secondary timeframe-btn active" data-timeframe="1h">1H</button>
                                    <button type="button" class="btn btn-sm btn-outline-secondary timeframe-btn" data-timeframe="4h">4H</button>
                                    <button type="button" class="btn btn-sm btn-outline-secondary timeframe-btn" data-timeframe="1d">1D</button>
                                    <button type="button" class="btn btn-sm btn-outline-secondary timeframe-btn" data-timeframe="1w">1W</button>
                                </div>
                            </div>
                            <div class="card-body">
                                <canvas id="price-chart" height="200"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="row">
                    <!-- Output Console -->
                    <div class="col-md-8">
                        <div class="card h-100">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <h5 class="mb-0"><i class="fas fa-terminal me-2"></i>Analysis Output</h5>
                                <div id="status-indicator" class="badge bg-secondary">Ready</div>
                            </div>
                            <div class="card-body">
                                <div id="output-console" class="output-console"></div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Trade History and Stats -->
                    <div class="col-md-4">
                        <div class="card h-100">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <h5 class="mb-0"><i class="fas fa-history me-2"></i>Trade History</h5>
                                <button class="btn btn-sm btn-outline-info" id="refresh-history"><i class="fas fa-sync-alt"></i></button>
                            </div>
                            <div class="card-body">
                                <div class="trade-stats mb-3">
                                    <div class="row">
                                        <div class="col-6">
                                            <div class="stat-card bg-success text-white">
                                                <div class="stat-title"><i class="fas fa-check-circle me-1"></i>Wins</div>
                                                <div id="win-count" class="stat-value">0</div>
                                            </div>
                                        </div>
                                        <div class="col-6">
                                            <div class="stat-card bg-danger text-white">
                                                <div class="stat-title"><i class="fas fa-times-circle me-1"></i>Losses</div>
                                                <div id="loss-count" class="stat-value">0</div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row mt-2">
                                        <div class="col-12">
                                            <div class="stat-card bg-primary text-white">
                                                <div class="stat-title"><i class="fas fa-percentage me-1"></i>Win Rate</div>
                                                <div id="win-rate" class="stat-value">0%</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="trade-chart-container mb-3">
                                    <canvas id="trade-chart"></canvas>
                                </div>
                                
                                <div class="trade-history">
                                    <h6><i class="fas fa-exchange-alt me-1"></i>Recent Trades</h6>
                                    <div id="trade-history-list" class="trade-history-list">
                                        <div class="text-center text-muted">No trades yet</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{{ url_for('static', filename='js/script.js') }}"></script>
</body>
</html> 
